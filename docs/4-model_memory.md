# Model Memory

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-model.Memory.random_uniform-start--->
## model.Memory.random_uniform

<!---Documatic-section-random_uniform-start--->
<!---Documatic-block-model.Memory.random_uniform-start--->
<details>
	<summary><code>model.Memory.random_uniform</code> code snippet</summary>

```python
def random_uniform(shape, low, high, cuda):
    x = torch.rand(*shape)
    result_cpu = (high - low) * x + low
    if cuda:
        return result_cpu.cuda()
    else:
        return result_cpu
```
</details>
<!---Documatic-block-model.Memory.random_uniform-end--->
<!---Documatic-section-random_uniform-end--->

# #
<!---Documatic-section-model.Memory.random_uniform-end--->

<!---Documatic-section-model.Memory.distance-start--->
## model.Memory.distance

<!---Documatic-section-distance-start--->
<!---Documatic-block-model.Memory.distance-start--->
<details>
	<summary><code>model.Memory.distance</code> code snippet</summary>

```python
def distance(a, b):
    return torch.sqrt(((a - b) ** 2).sum()).unsqueeze(0)
```
</details>
<!---Documatic-block-model.Memory.distance-end--->
<!---Documatic-section-distance-end--->

# #
<!---Documatic-section-model.Memory.distance-end--->

<!---Documatic-section-model.Memory.distance_batch-start--->
## model.Memory.distance_batch

<!---Documatic-section-distance_batch-start--->
```mermaid
flowchart LR
model.Memory.distance_batch-->model.Memory.distance
```

### Object Calls

* model.Memory.distance

<!---Documatic-block-model.Memory.distance_batch-start--->
<details>
	<summary><code>model.Memory.distance_batch</code> code snippet</summary>

```python
def distance_batch(a, b):
    (bs, _) = a.shape
    result = distance(a[0], b)
    for i in range(bs - 1):
        result = torch.cat((result, distance(a[i], b)), 0)
    return result
```
</details>
<!---Documatic-block-model.Memory.distance_batch-end--->
<!---Documatic-section-distance_batch-end--->

# #
<!---Documatic-section-model.Memory.distance_batch-end--->

<!---Documatic-section-model.Memory.multiply-start--->
## model.Memory.multiply

<!---Documatic-section-multiply-start--->
<!---Documatic-block-model.Memory.multiply-start--->
<details>
	<summary><code>model.Memory.multiply</code> code snippet</summary>

```python
def multiply(x):
    return functools.reduce(lambda x, y: x * y, x, 1)
```
</details>
<!---Documatic-block-model.Memory.multiply-end--->
<!---Documatic-section-multiply-end--->

# #
<!---Documatic-section-model.Memory.multiply-end--->

<!---Documatic-section-model.Memory.flatten-start--->
## model.Memory.flatten

<!---Documatic-section-flatten-start--->
```mermaid
flowchart LR
model.Memory.flatten-->model.Memory.multiply
```

### Object Calls

* model.Memory.multiply

<!---Documatic-block-model.Memory.flatten-start--->
<details>
	<summary><code>model.Memory.flatten</code> code snippet</summary>

```python
def flatten(x):
    count = multiply(x.size())
    return x.resize_(count)
```
</details>
<!---Documatic-block-model.Memory.flatten-end--->
<!---Documatic-section-flatten-end--->

# #
<!---Documatic-section-model.Memory.flatten-end--->

<!---Documatic-section-model.Memory.index-start--->
## model.Memory.index

<!---Documatic-section-index-start--->
<!---Documatic-block-model.Memory.index-start--->
<details>
	<summary><code>model.Memory.index</code> code snippet</summary>

```python
def index(batch_size, x):
    idx = torch.arange(0, batch_size).long()
    idx = torch.unsqueeze(idx, -1)
    return torch.cat((idx, x), dim=1)
```
</details>
<!---Documatic-block-model.Memory.index-end--->
<!---Documatic-section-index-end--->

# #
<!---Documatic-section-model.Memory.index-end--->

<!---Documatic-section-model.Memory.MemoryLoss-start--->
## model.Memory.MemoryLoss

<!---Documatic-section-MemoryLoss-start--->
<!---Documatic-block-model.Memory.MemoryLoss-start--->
<details>
	<summary><code>model.Memory.MemoryLoss</code> code snippet</summary>

```python
def MemoryLoss(memory):
    (m, d) = memory.size()
    memory_t = torch.t(memory)
    similarity = torch.matmul(memory, memory_t) / 2 + 1 / 2
    identity_mask = torch.eye(m).cuda()
    sim = torch.abs(similarity - identity_mask)
    return torch.sum(sim) / (m * (m - 1))
```
</details>
<!---Documatic-block-model.Memory.MemoryLoss-end--->
<!---Documatic-section-MemoryLoss-end--->

# #
<!---Documatic-section-model.Memory.MemoryLoss-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)